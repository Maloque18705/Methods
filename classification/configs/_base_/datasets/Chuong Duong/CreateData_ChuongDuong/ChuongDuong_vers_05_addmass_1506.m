%% Chuong Duong version 1008_final
% 10-08-2023

clc
clear
close all

% Units: m, kN
% ------------------------------------------------------------------------------
% Nodes=[NodID X Y Z]
Nodes=[
101	0	0	0
102	8.64	0	0
103	16.64	0	0
104	24.64	0	0
105	32.64	0	0
106	40.64	0	0
107	48.64	0	0
108	56.64	0	0
109	64.64	0	0
110	72.64	0	0
111	80.64	0	0
112	89.28	0	0
201	0	8.548	0
202	8.64	8.548	0
203	16.64	8.548	0
204	24.64	8.548	0
205	32.64	8.548	0
206	40.64	8.548	0
207	48.64	8.548	0
208	56.64	8.548	0
209	64.64	8.548	0
210	72.64	8.548	0
211	80.64	8.548	0
212	89.28	8.548	0
301	4.999	0	6.365
302	8.64	0	6.365
303	16.64	0	6.365
304	24.64	0	6.365
305	32.64	0	6.365
306	40.64	0	6.365
307	48.64	0	6.365
308	56.64	0	6.365
309	64.64	0	6.365
310	72.64	0	6.365
311	80.64	0	6.365
312	84.281	0	6.365
401	4.999	8.548	6.365
402	8.64	8.548	6.365
403	16.64	8.548	6.365
404	24.64	8.548	6.365
405	32.64	8.548	6.365
406	40.64	8.548	6.365
407	48.64	8.548	6.365
408	56.64	8.548	6.365
409	64.64	8.548	6.365
410	72.64	8.548	6.365
411	80.64	8.548	6.365
412	84.281	8.548	6.365
502	8.64	0	11
503	16.64	0	11
504	24.64	0	11
505	32.64	0	11
506	40.64	0	11
507	48.64	0	11
508	56.64	0	11
509	64.64	0	11
510	72.64	0	11
511	80.64	0	11
602	8.64	8.548	11
603	16.64	8.548	11
604	24.64	8.548	11
605	32.64	8.548	11
606	40.64	8.548	11
607	48.64	8.548	11
608	56.64	8.548	11
609	64.64	8.548	11
610	72.64	8.548	11
611	80.64	8.548	11
701	6.82	1.425	8.683
702	8.64	1.425	8.683
703	16.64	1.425	8.683
704	24.64	1.425	8.683
705	32.64	1.425	8.683
706	40.64	1.425	8.683
707	48.64	1.425	8.683
708	56.64	1.425	8.683
709	64.64	1.425	8.683
710	72.64	1.425	8.683
711	80.64	1.425	8.683
712	82.46	1.425	8.683
801	6.82	4.274	8.683
802	8.64	4.274	8.683
803	16.64	4.274	8.683
804	24.64	4.274	8.683
805	32.64	4.274	8.683
806	40.64	4.274	8.683
807	48.64	4.274	8.683
808	56.64	4.274	8.683
809	64.64	4.274	8.683
810	72.64	4.274	8.683
811	80.64	4.274	8.683
812	82.46	4.274	8.683
901	6.82	7.123	8.683
902	8.64	7.123	8.683
903	16.64	7.123	8.683
904	24.64	7.123	8.683
905	32.64	7.123	8.683
906	40.64	7.123	8.683
907	48.64	7.123	8.683
908	56.64	7.123	8.683
909	64.64	7.123	8.683
910	72.64	7.123	8.683
911	80.64	7.123	8.683
912	82.46	7.123	8.683
1002	8.64	2.849	11
1003	16.64	2.849	11
1004	24.64	2.849	11
1005	32.64	2.849	11
1006	40.64	2.849	11
1007	48.64	2.849	11
1008	56.64	2.849	11
1009	64.64	2.849	11
1010	72.64	2.849	11
1011	80.64	2.849	11
1102	8.64	5.699	11
1103	16.64	5.699	11
1104	24.64	5.699	11
1105	32.64	5.699	11
1106	40.64	5.699	11
1107	48.64	5.699	11
1108	56.64	5.699	11
1109	64.64	5.699	11
1110	72.64	5.699	11
1111	80.64	5.699	11
% 10101	0	0	0
% 10102	8.64	0	0
% 10103	16.64	0	0
% 10104	24.64	0	0
% 10105	32.64	0	0
% 10106	40.64	0	0
% 10107	48.64	0	0
% 10108	56.64	0	0
% 10109	64.64	0	0
% 10110	72.64	0	0
% 10111	80.64	0	0
% 10112	89.28	0	0
% 10201	0	8.548	0
% 10202	8.64	8.548	0
% 10203	16.64	8.548	0
% 10204	24.64	8.548	0
% 10205	32.64	8.548	0
% 10206	40.64	8.548	0
% 10207	48.64	8.548	0
% 10208	56.64	8.548	0
% 10209	64.64	8.548	0
% 10210	72.64	8.548	0
% 10211	80.64	8.548	0
% 10212	89.28	8.548	0
10301	0	1.214	0
10302	4.32	1.214	0
10303	8.64	1.214	0
10304	12.64	1.214	0
10305	16.64	1.214	0
10306	20.64	1.214	0
10307	24.64	1.214	0
10308	28.64	1.214	0
10309	32.64	1.214	0
10310	36.64	1.214	0
10311	40.64	1.214	0
10312	44.64	1.214	0
10313	48.64	1.214	0
10314	52.64	1.214	0
10315	56.64	1.214	0
10316	60.64	1.214	0
10317	64.64	1.214	0
10318	68.64	1.214	0
10319	72.64	1.214	0
10320	76.64	1.214	0
10321	80.64	1.214	0
10322	84.96	1.214	0
10323	89.28	1.214	0
10501	0	2.744	0
10502	4.32	2.744	0
10503	8.64	2.744	0
10504	12.64	2.744	0
10505	16.64	2.744	0
10506	20.64	2.744	0
10507	24.64	2.744	0
10508	28.64	2.744	0
10509	32.64	2.744	0
10510	36.64	2.744	0
10511	40.64	2.744	0
10512	44.64	2.744	0
10513	48.64	2.744	0
10514	52.64	2.744	0
10515	56.64	2.744	0
10516	60.64	2.744	0
10517	64.64	2.744	0
10518	68.64	2.744	0
10519	72.64	2.744	0
10520	76.64	2.744	0
10521	80.64	2.744	0
10522	84.96	2.744	0
10523	89.28	2.744	0
10701	0	4.274	0
10702	4.32	4.274	0
10703	8.64	4.274	0
10704	12.64	4.274	0
10705	16.64	4.274	0
10706	20.64	4.274	0
10707	24.64	4.274	0
10708	28.64	4.274	0
10709	32.64	4.274	0
10710	36.64	4.274	0
10711	40.64	4.274	0
10712	44.64	4.274	0
10713	48.64	4.274	0
10714	52.64	4.274	0
10715	56.64	4.274	0
10716	60.64	4.274	0
10717	64.64	4.274	0
10718	68.64	4.274	0
10719	72.64	4.274	0
10720	76.64	4.274	0
10721	80.64	4.274	0
10722	84.96	4.274	0
10723	89.28	4.274	0
10601	0	5.804	0
10602	4.32	5.804	0
10603	8.64	5.804	0
10604	12.64	5.804	0
10605	16.64	5.804	0
10606	20.64	5.804	0
10607	24.64	5.804	0
10608	28.64	5.804	0
10609	32.64	5.804	0
10610	36.64	5.804	0
10611	40.64	5.804	0
10612	44.64	5.804	0
10613	48.64	5.804	0
10614	52.64	5.804	0
10615	56.64	5.804	0
10616	60.64	5.804	0
10617	64.64	5.804	0
10618	68.64	5.804	0
10619	72.64	5.804	0
10620	76.64	5.804	0
10621	80.64	5.804	0
10622	84.96	5.804	0
10623	89.28	5.804	0
10401	0	7.334	0
10402	4.32	7.334	0
10403	8.64	7.334	0
10404	12.64	7.334	0
10405	16.64	7.334	0
10406	20.64	7.334	0
10407	24.64	7.334	0
10408	28.64	7.334	0
10409	32.64	7.334	0
10410	36.64	7.334	0
10411	40.64	7.334	0
10412	44.64	7.334	0
10413	48.64	7.334	0
10414	52.64	7.334	0
10415	56.64	7.334	0
10416	60.64	7.334	0
10417	64.64	7.334	0
10418	68.64	7.334	0
10419	72.64	7.334	0
10420	76.64	7.334	0
10421	80.64	7.334	0
10422	84.96	7.334	0
10423	89.28	7.334	0

% Goi
100001	0	0	-1
100002	-1	0	0
200001	0	8.548	-1
200002	-1	8.548	0
100012	89.28	0	-1
200012	89.28	8.548	-1
9999	1	1	1

% Canh ga
2101	0	-1.106	0
3101	0	-3.206	0
4101	0	-5.306	0
5101	0	9.654	0
6101	0	11.754	0
7101	0	13.854	0
2102	8.64	-1.106	0
3102	8.64	-3.206	0
4102	8.64	-5.306	0
5102	8.64	9.654	0
6102	8.64	11.754	0
7102	8.64	13.854	0
2103	16.64	-1.106	0
3103	16.64	-3.206	0
4103	16.64	-5.306	0
5103	16.64	9.654	0
6103	16.64	11.754	0
7103	16.64	13.854	0
2104	24.64	-1.106	0
3104	24.64	-3.206	0
4104	24.64	-5.306	0
5104	24.64	9.654	0
6104	24.64	11.754	0
7104	24.64	13.854	0
2105	32.64	-1.106	0
3105	32.64	-3.206	0
4105	32.64	-5.306	0
5105	32.64	9.654	0
6105	32.64	11.754	0
7105	32.64	13.854	0
2106	40.64	-1.106	0
3106	40.64	-3.206	0
4106	40.64	-5.306	0
5106	40.64	9.654	0
6106	40.64	11.754	0
7106	40.64	13.854	0
2107	48.64	-1.106	0
3107	48.64	-3.206	0
4107	48.64	-5.306	0
5107	48.64	9.654	0
6107	48.64	11.754	0
7107	48.64	13.854	0
2108	56.64	-1.106	0
3108	56.64	-3.206	0
4108	56.64	-5.306	0
5108	56.64	9.654	0
6108	56.64	11.754	0
7108	56.64	13.854	0
2109	64.64	-1.106	0
3109	64.64	-3.206	0
4109	64.64	-5.306	0
5109	64.64	9.654	0
6109	64.64	11.754	0
7109	64.64	13.854	0
2110	72.64	-1.106	0
3110	72.64	-3.206	0
4110	72.64	-5.306	0
5110	72.64	9.654	0
6110	72.64	11.754	0
7110	72.64	13.854	0
2111	80.64	-1.106	0
3111	80.64	-3.206	0
4111	80.64	-5.306	0
5111	80.64	9.654	0
6111	80.64	11.754	0
7111	80.64	13.854	0
2112	89.28	-1.106	0
3112	89.28	-3.206	0
4112	89.28	-5.306	0
5112	89.28	9.654	0
6112	89.28	11.754	0
7112	89.28	13.854	0

];

L_span=89.28;
% seldof_mass=[(101:112)'+0.03 ; (201:212)'+0.03];
P_concrete = (1850.6/89.28)*8.64; %kn/m3
P_deck = (178/89.28)*8.64; %kn/m3
P_crossbeam = 27; %kn/m3

F_crossbeam = 27*0.3473; %kn/m3
F_concrete = P_concrete*74.267; %kn/m3
F_deck = P_deck*178.78; %kn/m3
F_1 = (F_crossbeam+F_concrete+F_deck)/6;  
F_2 = (F_crossbeam+F_concrete+F_deck)/3;   
% Element types -> {EltTypID EltName}
Types= {1 'beam'
    2  'link'
    3 'mass';}; 
% -------------------------------------------------------------------------------
A_1	=	0.059136	;	%	m2
Iyy_1	=	0.001657345	;	%	m4
Izz_1	=	0.004052161	;	%	m4

A_2	=	0.0668	;	%	m2	66800
Iyy_2	=	0.035779187	;	%	m4	35779186666
Izz_2	=	0.001467507	;	%	m4	1.47E+09

A_3	=	0.013152	;	%	m2
Iyy_3	=	3.52349E-05	;	%	m4
Izz_3	=	0.000730538	;	%	m4
A_31	=	0.015072	;	%	m2
Iyy_31	=	7.86909E-05	;	%	m4
Izz_31	=	0.000896519	;	%	m4
A_41	=	0.027456	;	%	m2
Iyy_41	=	0.001831615	;	%	m4
Izz_41	=	0.000878149	;	%	m4
A_42	=	0.024576	;	%	m2
Iyy_42	=	0.001582645	;	%	m4
Izz_42	=	0.000524485	;	%	m4
A_43	=	0.023616	;	%	m2
Iyy_43	=	0.001499655	;	%	m4
Izz_43	=	0.000432197	;	%	m4
A_44	=	0.019296	;	%	m2
Iyy_44	=	0.0011262	;	%	m4
Izz_44	=	0.000148373	;	%	m4
A_45	=	0.016416	;	%	m2
Iyy_45	=	0.00087723	;	%	m4
Izz_45	=	5.41966E-05	;	%	m4
A_5	=	0.0086	;	%	m2
Iyy_5	=	0.000228287	;	%	m4
Izz_5	=	2.30717E-05	;	%	m4
A_51	=	0.0077	;	%	m2
Iyy_51	=	0.000128364	;	%	m4
Izz_51	=	2.30642E-05	;	%	m4

A_61	=	0.005952	;	%	m2
Iyy_61	=	3.28694E-05	;	%	m4
Izz_61	=	8.1705E-06	;	%	m4
A_62	=	0.0039	;	%	m2
Iyy_62	=	1.30675E-05	;	%	m4
Izz_62	=	0.00000349	;	%	m4

A_71	=	0.005	;	%	m2
Iyy_71	=	4.59267E-05	;	%	m4
Izz_71	=	4.59167E-06	;	%	m4
A_72	=	0.0058	;	%	m2
Iyy_72	=	5.94833E-06	;	%	m4
Izz_72	=	4.55183E-05	;	%	m4

A_8	=	0.059136	;	%	m2
Iyy_8	=	0.004052161	;	%	m4
Izz_8	=	0.001657345	;	%	m4

% Sections=[SecID A ky kz Ixx Iyy Izz yt yb zt zb]
%           1 A_u1 Inf Inf 0 Iz_u1 Iy_u1 yt yb b/2 b/2
Sections=[ 1  A_1 Inf Inf  0  Iyy_1  Izz_1 380 380 290 290;
           2  A_2 Inf Inf  0 Iyy_2  Izz_2 155 155 120 120;
         3 A_3 Inf Inf 0 Iyy_3  Izz_3 300 300 130 130  ;
         31 A_31 Inf Inf 0 Iyy_31  Izz_31 300 300 170 170;
         41 A_41 Inf Inf 0 Iyy_41  Izz_41 300 300 380 380;
         42 A_42 Inf Inf 0 Iyy_42  Izz_42 300 300 320 320;
         43 A_43 Inf Inf 0 Iyy_43  Izz_43 300 300 300 300;
         44 A_44 Inf Inf 0 Iyy_44  Izz_44 300 300 210 210;
         45 A_45 Inf Inf 0 Iyy_45  Izz_45 300 300 150 150; 
         5 A_5 Inf Inf 0 Iyy_5  Izz_5 200 200 120 120 ;
         51  A_51 Inf Inf  0 Iyy_51  Izz_51 155 155 120 120;
         61 A_61 Inf Inf 0 Iyy_61  Izz_61 0 0 0 0
         62 A_62 Inf Inf 0 Iyy_62  Izz_62 0 0 0 0
         71 A_71 Inf Inf 0 Iyy_71  Izz_71 0 0 0 0
         72 A_72 Inf Inf 0 Iyy_72  Izz_72 0 0 0 0 
         8 A_8 Inf Inf 0 Iyy_8  Izz_8 0 0 0 0 
         9 F_1 nan nan nan nan nan nan nan nan nan       %mass
         11 F_2 nan nan nan nan nan nan nan nan nan 
         10 Inf Inf Inf Inf Inf Inf Inf Inf Inf Inf
         ];   %spring stiffness 
% -------------------------------------------------------------------------------
% Materials = [MatID E nu rho k];
 Materials= [1  2e11   0.3 7850    Inf; %x1+5%
 2  2.1e11  0.3 7850 Inf  %x2+5%
 3  2.09e11  0.3 7850 Inf  %x3+5% 
 31 2.09e11  0.3 7850 Inf  
 4  2.09e11  0.3 7850 Inf    
 5  2.09e11  0.3 7850 Inf  
 51  2.09e11  0.3 7850 Inf  
  61  2.09e11  0.3 7850 Inf 
   62  2.09e11  0.3 7850 Inf 
   99 nan nan nan nan      %Mat of added mass
   10 1 1 1 1.92e10
   11 1 1 1 1.76e5
 ]; % other
% Elements=[EltID TypID SecID MatID n1 n2 n3]
Elements= [

1	1	1	1	101	102	9999
2	1	1	1	102	103	9999
3	1	1	1	103	104	9999
4	1	1	1	104	105	9999
5	1	1	1	105	106	9999
6	1	1	1	106	107	9999
7	1	1	1	107	108	9999
8	1	1	1	108	109	9999
9	1	1	1	109	110	9999
10	1	1	1	110	111	9999
11	1	1	1	111	112	9999
12	1	1	1	201	202	9999
13	1	1	1	202	203	9999
14	1	1	1	203	204	9999
15	1	1	1	204	205	9999
16	1	1	1	205	206	9999
17	1	1	1	206	207	9999
18	1	1	1	207	208	9999
19	1	1	1	208	209	9999
20	1	1	1	209	210	9999
21	1	1	1	210	211	9999
22	1	1	1	211	212	9999
23	1	1	1	502	503	9999
24	1	1	1	503	504	9999
25	1	1	1	504	505	9999
26	1	1	1	505	506	9999
27	1	1	1	506	507	9999
28	1	1	1	507	508	9999
29	1	1	1	508	509	9999
30	1	1	1	509	510	9999
31	1	1	1	510	511	9999
32	1	1	1	602	603	9999
33	1	1	1	603	604	9999
34	1	1	1	604	605	9999
35	1	1	1	605	606	9999
36	1	1	1	606	607	9999
37	1	1	1	607	608	9999
38	1	1	1	608	609	9999
39	1	1	1	609	610	9999
40	1	1	1	610	611	9999

% Dam ngang
100	1	2	2	101	201	9999
102	1	2	2	102	202	9999
103	1	2	2	103	203	9999
104	1	2	2	104	204	9999
105	1	2	2	105	205	9999
106	1	2	2	106	206	9999
107	1	2	2	107	207	9999
108	1	2	2	108	208	9999
109	1	2	2	109	209	9999
110	1	2	2	110	210	9999
111	1	2	2	111	211	9999
112	1	2	2	112	212	9999
113	1	2	2	502	1002	9999
114	1	2	2	503	1003	9999
115	1	2	2	504	1004	9999
116	1	2	2	505	1005	9999
117	1	2	2	506	1006	9999
118	1	2	2	507	1007	9999
119	1	2	2	508	1008	9999
120	1	2	2	509	1009	9999
121	1	2	2	510	1010	9999
122	1	2	2	511	1011	9999
123	1	2	2	1002	1102	9999
124	1	2	2	1003	1103	9999
125	1	2	2	1004	1104	9999
126	1	2	2	1005	1105	9999
127	1	2	2	1006	1106	9999
128	1	2	2	1007	1107	9999
129	1	2	2	1008	1108	9999
130	1	2	2	1009	1109	9999
131	1	2	2	1010	1110	9999
132	1	2	2	1011	1111	9999
133	1	2	2	1102	602	9999
134	1	2	2	1103	603	9999
135	1	2	2	1104	604	9999
136	1	2	2	1105	605	9999
137	1	2	2	1106	606	9999
138	1	2	2	1107	607	9999
139	1	2	2	1108	608	9999
140	1	2	2	1109	609	9999
141	1	2	2	1110	610	9999
142	1	2	2	1111	611	9999

% Thanh dung
201	1	3	3	102	302	9999  %201	1	3	3	102	10102	9999
202	1	3	3	103	303	9999
203	1	3	3	104	304	9999
204	1	3	3	105	305	9999
205	1	3	3	106	306	9999
206	1	31	31	107	307	9999
207	1	3	3	108	308	9999
208	1	3	3	109	309	9999
209	1	3	3	110	310	9999
210	1	3	3	111	311	9999

211	1	3	3	302	502	9999
212	1	3	3	303	503	9999
213	1	3	3	304	504	9999
214	1	3	3	305	505	9999
215	1	3	3	306	506	9999
216	1	31	31	307	507	9999
217	1	3	3	308	508	9999
218	1	3	3	309	509	9999
219	1	3	3	310	510	9999
220	1	3	3	311	511	9999

221	1	3	3	202	402	9999
222	1	3	3	203	403	9999
223	1	3	3	204	404	9999
224	1	3	3	205	405	9999
225	1	3	3	206	406	9999
226	1	31	31	207	407	9999
227	1	3	3	208	408	9999
228	1	3	3	209	409	9999
229	1	3	3	210	410	9999
230	1	3	3	211	411	9999

231	1	3	3	402	602	9999
232	1	3	3	403	603	9999
233	1	3	3	404	604	9999
234	1	3	3	405	605	9999
235	1	3	3	406	606	9999
236	1	31	31	407	607	9999
237	1	3	3	408	608	9999
238	1	3	3	409	609	9999
239	1	3	3	410	610	9999
240	1	3	3	411	611	9999

% He giang
302	1	62	62	303	703	9999
303	1	62	62	304	704	9999
304	1	62	62	305	705	9999
305	1	62	62	306	706	9999
306	1	62	62	307	707	9999
307	1	62	62	308	708	9999
308	1	62	62	309	709	9999
309	1	62	62	310	710	9999
						
						
312	1	62	62	703	1003	9999
313	1	62	62	704	1004	9999
314	1	62	62	705	1005	9999
315	1	62	62	706	1006	9999
316	1	62	62	707	1007	9999
317	1	62	62	708	1008	9999
318	1	62	62	709	1009	9999
319	1	62	62	710	1010	9999
						
						
322	1	61	61	1003	803	9999
323	1	61	61	1004	804	9999
324	1	61	61	1005	805	9999
325	1	61	61	1006	806	9999
326	1	61	61	1007	807	9999
327	1	61	61	1008	808	9999
328	1	61	61	1009	809	9999
329	1	61	61	1010	810	9999
						
						
332	1	61	61	803	1103	9999
333	1	61	61	804	1104	9999
334	1	61	61	805	1105	9999
335	1	61	61	806	1106	9999
336	1	61	61	807	1107	9999
337	1	61	61	808	1108	9999
338	1	61	61	809	1109	9999
339	1	61	61	810	1110	9999
						
						
342	1	62	62	1103	903	9999
343	1	62	62	1104	904	9999
344	1	62	62	1105	905	9999
345	1	62	62	1106	906	9999
346	1	62	62	1107	907	9999
347	1	62	62	1108	908	9999
348	1	62	62	1109	909	9999
349	1	62	62	1110	910	9999
						
						
352	1	62	62	903	403	9999
353	1	62	62	904	404	9999
354	1	62	62	905	405	9999
355	1	62	62	906	406	9999
356	1	62	62	907	407	9999
357	1	62	62	908	408	9999
358	1	62	62	909	409	9999
359	1	62	62	910	410	9999
						
						
362	1	62	62	703	803	9999
363	1	62	62	704	804	9999
364	1	62	62	705	805	9999
365	1	62	62	706	806	9999
366	1	62	62	707	807	9999
367	1	62	62	708	808	9999
368	1	62	62	709	809	9999
369	1	62	62	710	810	9999
						
						
372	1	62	62	803	903	9999
373	1	62	62	804	904	9999
374	1	62	62	805	905	9999
375	1	62	62	806	906	9999
376	1	62	62	807	907	9999
377	1	62	62	808	908	9999
378	1	62	62	809	909	9999
379	1	62	62	810	910	9999
						
						
382	1	62	62	703	503	9999
383	1	62	62	704	504	9999
384	1	62	62	705	505	9999
385	1	62	62	706	506	9999
386	1	62	62	707	507	9999
387	1	62	62	708	508	9999
388	1	62	62	709	509	9999
389	1	62	62	710	510	9999
						
						
392	1	62	62	903	603	9999
393	1	62	62	904	604	9999
394	1	62	62	905	605	9999
395	1	62	62	906	606	9999
396	1	62	62	907	607	9999
397	1	62	62	908	608	9999
398	1	62	62	909	609	9999
399	1	62	62	910	610	9999

% Thanh xien
401	1	41	1	502	103	9999
402	1	43	1	504	105	9999
403	1	44	1	506	107	9999
404	1	45	1	507	108	9999
405	1	43	1	509	110	9999
406	1	41	1	602	203	9999
407	1	43	1	604	205	9999
408	1	44	1	606	207	9999
409	1	45	1	607	208	9999
410	1	43	1	609	210	9999
411	1	42	1	103	504	9999
412	1	43	1	105	506	9999
413	1	45	1	107	508	9999
414	1	44	1	108	509	9999
415	1	41	1	110	511	9999
416	1	42	1	203	604	9999
417	1	43	1	205	606	9999
418	1	45	1	207	608	9999
419	1	44	1	208	609	9999
420	1	41	1	210	611	9999

% He giang bien tren va duoi
501	1	5	5	101	202	9999
502	1	5	5	102	203	9999
503	1	5	5	103	204	9999
504	1	5	5	104	205	9999
505	1	5	5	105	206	9999
506	1	5	5	106	207	9999
507	1	5	5	107	208	9999
508	1	5	5	108	209	9999
509	1	5	5	109	210	9999
510	1	5	5	110	211	9999
511	1	5	5	111	212	9999
512	1	5	5	201	102	9999
513	1	5	5	202	103	9999
514	1	5	5	203	104	9999
515	1	5	5	204	105	9999
516	1	5	5	205	106	9999
517	1	5	5	206	107	9999
518	1	5	5	207	108	9999
519	1	5	5	208	109	9999
520	1	5	5	209	110	9999
521	1	5	5	210	111	9999
522	1	5	5	211	112	9999
523	1	51	51	502	603	9999
524	1	51	51	503	604	9999
525	1	51	51	504	605	9999
526	1	51	51	505	606	9999
527	1	51	51	506	607	9999
528	1	51	51	507	608	9999
529	1	51	51	508	609	9999
530	1	51	51	509	610	9999
531	1	51	51	510	611	9999
532	1	51	51	602	503	9999
533	1	51	51	603	504	9999
534	1	51	51	604	505	9999
535	1	51	51	605	506	9999
536	1	51	51	606	507	9999
537	1	51	51	607	508	9999
538	1	51	51	608	509	9999
539	1	51	51	609	510	9999
540	1	51	51	610	511	9999

% Cong cau
601	1	1	1	101	301	9999
603	1	1	1	301	502	9999
604	1	71	1	301	701	9999
605	1	71	1	701	1002	9999
606	1	72	1	1002	801	9999
607	1	72	1	801	1102	9999
608	1	71	1	1102	901	9999
609	1	71	1	901	401	9999
610	1	72	1	502	701	9999
611	1	72	1	602	901	9999
612	1	72	1	701	801	9999
613	1	72	1	801	901	9999
614	1	1	1	201	401	9999    %614	1	1	1	201	10201	9999 

616	1	1	1	401	602	9999
617	1	1	1	112	312	9999   %617	1	1	1	112	10112	9999
619	1	1	1	312	511	9999
620	1	71	1	312	712	9999
621	1	71	1	712	1011	9999
622	1	72	1	1011	812	9999
623	1	72	1	812	1111	9999
624	1	71	1	1111	912	9999
625	1	71	1	912	412	9999
626	1	72	1	611	912	9999
627	1	72	1	511	712	9999
628	1	1	1	611	412	9999
629	1	1	1	412	212	9999  %629	1	1	1	412	10212	9999

631	1	72	1	712	812	9999
632	1	72	1	812	912	9999


% DAM NGANG MAT CAU
701	1	2	1	101	10301	9999 %701	1	8	1	10101	10301	9999
702	1	2	1	102	10303	9999
703	1	2	1	103	10305	9999
704	1	2	1	104	10307	9999
705	1	2	1	105	10309	9999
706	1	2	1	106	10311	9999
707	1	2	1	107	10313	9999
708	1	2	1	108	10315	9999
709	1	2	1	109	10317	9999
710	1	2	1	110	10319	9999
711	1	2	1	111	10321	9999
712	1	2	1	112	10323	9999
713	1	2	1	10301	10501	9999
714	1	2	1	10302	10502	9999
715	1	2	1	10303	10503	9999
716	1	2	1	10304	10504	9999
717	1	2	1	10305	10505	9999
718	1	2	1	10306	10506	9999
719	1	2	1	10307	10507	9999
720	1	2	1	10308	10508	9999
721	1	2	1	10309	10509	9999
722	1	2	1	10310	10510	9999
723	1	2	1	10311	10511	9999
724	1	2	1	10312	10512	9999
725	1	2	1	10313	10513	9999
726	1	2	1	10314	10514	9999
727	1	2	1	10315	10515	9999
728	1	2	1	10316	10516	9999
729	1	2	1	10317	10517	9999
730	1	2	1	10318	10518	9999
731	1	2	1	10319	10519	9999
732	1	2	1	10320	10520	9999
733	1	2	1	10321	10521	9999
734	1	2	1	10322	10522	9999
735	1	2	1	10323	10523	9999
736	1	2	1	10501	10701	9999
737	1	2	1	10502	10702	9999
738	1	2	1	10503	10703	9999
739	1	2	1	10504	10704	9999
740	1	2	1	10505	10705	9999
741	1	2	1	10506	10706	9999
742	1	2	1	10507	10707	9999
743	1	2	1	10508	10708	9999
744	1	2	1	10509	10709	9999
745	1	2	1	10510	10710	9999
746	1	2	1	10511	10711	9999
747	1	2	1	10512	10712	9999
748	1	2	1	10513	10713	9999
749	1	2	1	10514	10714	9999
750	1	2	1	10515	10715	9999
751	1	2	1	10516	10716	9999
752	1	2	1	10517	10717	9999
753	1	2	1	10518	10718	9999
754	1	2	1	10519	10719	9999
755	1	2	1	10520	10720	9999
756	1	2	1	10521	10721	9999
757	1	2	1	10522	10722	9999
758	1	2	1	10523	10723	9999

759	1	2	1	10701	10601	9999
760	1	2	1	10702	10602	9999
761	1	2	1	10703	10603	9999
762	1	2	1	10704	10604	9999
763	1	2	1	10705	10605	9999
764	1	2	1	10706	10606	9999
765	1	2	1	10707	10607	9999
766	1	2	1	10708	10608	9999
767	1	2	1	10709	10609	9999
768	1	2	1	10710	10610	9999
769	1	2	1	10711	10611	9999
770	1	2	1	10712	10612	9999
771	1	2	1	10713	10613	9999
772	1	2	1	10714	10614	9999
773	1	2	1	10715	10615	9999
774	1	2	1	10716	10616	9999
775	1	2	1	10717	10617	9999
776	1	2	1	10718	10618	9999
777	1	2	1	10719	10619	9999
778	1	2	1	10720	10620	9999
779	1	2	1	10721	10621	9999
780	1	2	1	10722	10622	9999
781	1	2	1	10723	10623	9999
782	1	2	1	10601	10401	9999

783	1	2	1	10602	10402	9999
784	1	2	1	10603	10403	9999
785	1	2	1	10604	10404	9999
786	1	2	1	10605	10405	9999
787	1	2	1	10606	10406	9999
788	1	2	1	10607	10407	9999
789	1	2	1	10608	10408	9999
790	1	2	1	10609	10409	9999
791	1	2	1	10610	10410	9999
792	1	2	1	10611	10411	9999
793	1	2	1	10612	10412	9999
794	1	2	1	10613	10413	9999
795	1	2	1	10614	10414	9999
796	1	2	1	10615	10415	9999
797	1	2	1	10616	10416	9999
798	1	2	1	10617	10417	9999
799	1	2	1	10618	10418	9999
800	1	2	1	10619	10419	9999
801	1	2	1	10620	10420	9999
802	1	2	1	10621	10421	9999
803	1	2	1	10622	10422	9999
804	1	2	1	10623	10423	9999

805	1	2	1	10401	201	9999 %805	1	8	1	10401	10201	9999
806	1	2	1	10403	202	9999
807	1	2	1	10405	203	9999
808	1	2	1	10407	204	9999
809	1	2	1	10409	205	9999
810	1	2	1	10411	206	9999
811	1	2	1	10413	207	9999
812	1	2	1	10415	208	9999
813	1	2	1	10417	209	9999
814	1	2	1	10419	210	9999
815	1	2	1	10421	211	9999
816	1	2	1	10423	212	9999

901	1	2	1	10301	10302	9999
902	1	2	1	10302	10303	9999
903	1	2	1	10303	10304	9999
904	1	2	1	10304	10305	9999
905	1	2	1	10305	10306	9999
906	1	2	1	10306	10307	9999
907	1	2	1	10307	10308	9999
908	1	2	1	10308	10309	9999
909	1	2	1	10309	10310	9999
910	1	2	1	10310	10311	9999
911	1	2	1	10311	10312	9999
912	1	2	1	10312	10313	9999
913	1	2	1	10313	10314	9999
914	1	2	1	10314	10315	9999
915	1	2	1	10315	10316	9999
916	1	2	1	10316	10317	9999
917	1	2	1	10317	10318	9999
918	1	2	1	10318	10319	9999
919	1	2	1	10319	10320	9999
920	1	2	1	10320	10321	9999
921	1	2	1	10321	10322	9999
922	1	2	1	10322	10323	9999
923	1	2	1	10501	10502	9999
924	1	2	1	10502	10503	9999
925	1	2	1	10503	10504	9999
926	1	2	1	10504	10505	9999
927	1	2	1	10505	10506	9999
928	1	2	1	10506	10507	9999
929	1	2	1	10507	10508	9999
930	1	2	1	10508	10509	9999
931	1	2	1	10509	10510	9999
932	1	2	1	10510	10511	9999
933	1	2	1	10511	10512	9999
934	1	2	1	10512	10513	9999
935	1	2	1	10513	10514	9999
936	1	2	1	10514	10515	9999
937	1	2	1	10515	10516	9999
938	1	2	1	10516	10517	9999
939	1	2	1	10517	10518	9999
940	1	2	1	10518	10519	9999
941	1	2	1	10519	10520	9999
942	1	2	1	10520	10521	9999
943	1	2	1	10521	10522	9999
944	1	2	1	10522	10523	9999
945	1	2	1	10701	10702	9999
946	1	2	1	10702	10703	9999
947	1	2	1	10703	10704	9999
948	1	2	1	10704	10705	9999
949	1	2	1	10705	10706	9999
950	1	2	1	10706	10707	9999
951	1	2	1	10707	10708	9999
952	1	2	1	10708	10709	9999
953	1	2	1	10709	10710	9999
954	1	2	1	10710	10711	9999
955	1	2	1	10711	10712	9999
956	1	2	1	10712	10713	9999
957	1	2	1	10713	10714	9999
958	1	2	1	10714	10715	9999
959	1	2	1	10715	10716	9999
960	1	2	1	10716	10717	9999
961	1	2	1	10717	10718	9999
962	1	2	1	10718	10719	9999
963	1	2	1	10719	10720	9999
964	1	2	1	10720	10721	9999
965	1	2	1	10721	10722	9999
966	1	2	1	10722	10723	9999
967	1	2	1	10601	10602	9999
968	1	2	1	10602	10603	9999
969	1	2	1	10603	10604	9999
970	1	2	1	10604	10605	9999
971	1	2	1	10605	10606	9999
972	1	2	1	10606	10607	9999
973	1	2	1	10607	10608	9999
974	1	2	1	10608	10609	9999
975	1	2	1	10609	10610	9999
976	1	2	1	10610	10611	9999
977	1	2	1	10611	10612	9999
978	1	2	1	10612	10613	9999
979	1	2	1	10613	10614	9999
980	1	2	1	10614	10615	9999
981	1	2	1	10615	10616	9999
982	1	2	1	10616	10617	9999
983	1	2	1	10617	10618	9999
984	1	2	1	10618	10619	9999
985	1	2	1	10619	10620	9999
986	1	2	1	10620	10621	9999
987	1	2	1	10621	10622	9999
988	1	2	1	10622	10623	9999
989	1	2	1	10401	10402	9999
990	1	2	1	10402	10403	9999
991	1	2	1	10403	10404	9999
992	1	2	1	10404	10405	9999
993	1	2	1	10405	10406	9999
994	1	2	1	10406	10407	9999
995	1	2	1	10407	10408	9999
996	1	2	1	10408	10409	9999
997	1	2	1	10409	10410	9999
998	1	2	1	10410	10411	9999
999	1	2	1	10411	10412	9999
1000	1	8	1	10412	10413	9999
1001	1	8	1	10413	10414	9999
1002	1	8	1	10414	10415	9999
1003	1	8	1	10415	10416	9999
1004	1	8	1	10416	10417	9999
1005	1	8	1	10417	10418	9999
1006	1	8	1	10418	10419	9999
1007	1	8	1	10419	10420	9999
1008	1	8	1	10420	10421	9999
1009	1	8	1	10421	10422	9999
1010	1	8	1	10422	10423	9999
% 1011	1	8	1	10101	10102	9999
% 1012	1	8	1	10102	10103	9999
% 1013	1	8	1	10103	10104	9999
% 1014	1	8	1	10104	10105	9999
% 1015	1	8	1	10105	10106	9999
% 1016	1	8	1	10106	10107	9999
% 1017	1	8	1	10107	10108	9999
% 1018	1	8	1	10108	10109	9999
% 1019	1	8	1	10109	10110	9999
% 1020	1	8	1	10110	10111	9999
% 1021	1	8	1	10111	10112	9999
% 1022	1	8	1	10201	10202	9999
% 1023	1	8	1	10202	10203	9999
% 1024	1	8	1	10203	10204	9999
% 1025	1	8	1	10204	10205	9999
% 1026	1	8	1	10205	10206	9999
% 1027	1	8	1	10206	10207	9999
% 1028	1	8	1	10207	10208	9999
% 1029	1	8	1	10208	10209	9999
% 1030	1	8	1	10209	10210	9999
% 1031	1	8	1	10210	10211	9999
% 1032	1	8	1	10211	10212	9999

%goi
10000 2   9   10  101   100001   NaN
10001 2   9   10  101   100002   NaN
10002 2   9   10  201   200001   NaN
10003 2   9   10  201   200002   NaN
10004 2   9   11  112   100012   NaN
10005 2   9   11  212   200012   NaN

% Canh ga
4000	1	8	1	101	2101	9999
4001	1	8	1	102	2102	9999
4002	1	8	1	103	2103	9999
4003	1	8	1	104	2104	9999
4004	1	8	1	105	2105	9999
4005	1	8	1	106	2106	9999
4006	1	8	1	107	2107	9999
4007	1	8	1	108	2108	9999
4008	1	8	1	109	2109	9999
4009	1	8	1	110	2110	9999
4010	1	8	1	111	2111	9999
4011	1	8	1	112	2112	9999
4012	1	8	1	2101	3101	9999
4013	1	8	1	2102	3102	9999
4014	1	8	1	2103	3103	9999
4015	1	8	1	2104	3104	9999
4016	1	8	1	2105	3105	9999
4017	1	8	1	2106	3106	9999
4018	1	8	1	2107	3107	9999
4019	1	8	1	2108	3108	9999
4020	1	8	1	2109	3109	9999
4021	1	8	1	2110	3110	9999
4022	1	8	1	2111	3111	9999
4023	1	8	1	2112	3112	9999
4024	1	8	1	3101	4101	9999
4025	1	8	1	3102	4102	9999
4026	1	8	1	3103	4103	9999
4027	1	8	1	3104	4104	9999
4028	1	8	1	3105	4105	9999
4029	1	8	1	3106	4106	9999
4030	1	8	1	3107	4107	9999
4031	1	8	1	3108	4108	9999
4032	1	8	1	3109	4109	9999
4033	1	8	1	3110	4110	9999
4034	1	8	1	3111	4111	9999
4035	1	8	1	3112	4112	9999
4036	1	8	1	201	5101	9999
4037	1	8	1	202	5102	9999
4038	1	8	1	203	5103	9999
4039	1	8	1	204	5104	9999
4040	1	8	1	205	5105	9999
4041	1	8	1	206	5106	9999
4042	1	8	1	207	5107	9999
4043	1	8	1	208	5108	9999
4044	1	8	1	209	5109	9999
4045	1	8	1	210	5110	9999
4046	1	8	1	211	5111	9999
4047	1	8	1	212	5112	9999
4048	1	8	1	5101	6101	9999
4049	1	8	1	5102	6102	9999
4050	1	8	1	5103	6103	9999
4051	1	8	1	5104	6104	9999
4052	1	8	1	5105	6105	9999
4053	1	8	1	5106	6106	9999
4054	1	8	1	5107	6107	9999
4055	1	8	1	5108	6108	9999
4056	1	8	1	5109	6109	9999
4057	1	8	1	5110	6110	9999
4058	1	8	1	5111	6111	9999
4059	1	8	1	5112	6112	9999
4060	1	8	1	6101	7101	9999
4061	1	8	1	6102	7102	9999
4062	1	8	1	6103	7103	9999
4063	1	8	1	6104	7104	9999
4064	1	8	1	6105	7105	9999
4065	1	8	1	6106	7106	9999
4066	1	8	1	6107	7107	9999
4067	1	8	1	6108	7108	9999
4068	1	8	1	6109	7109	9999
4069	1	8	1	6110	7110	9999
4070	1	8	1	6111	7111	9999
4071	1	8	1	6112	7112	9999
4072	1	8	1	2101	2102	9999
4073	1	8	1	2102	2103	9999
4074	1	8	1	2103	2104	9999
4075	1	8	1	2104	2105	9999
4076	1	8	1	2105	2106	9999
4077	1	8	1	2106	2107	9999
4078	1	8	1	2107	2108	9999
4079	1	8	1	2108	2109	9999
4080	1	8	1	2109	2110	9999
4081	1	8	1	2110	2111	9999
4082	1	8	1	2111	2112	9999
4083	1	8	1	3101	3102	9999
4084	1	8	1	3102	3103	9999
4085	1	8	1	3103	3104	9999
4086	1	8	1	3104	3105	9999
4087	1	8	1	3105	3106	9999
4088	1	8	1	3106	3107	9999
4089	1	8	1	3107	3108	9999
4090	1	8	1	3108	3109	9999
4091	1	8	1	3109	3110	9999
4092	1	8	1	3110	3111	9999
4093	1	8	1	3111	3112	9999
4094	1	8	1	4101	4102	9999
4095	1	8	1	4102	4103	9999
4096	1	8	1	4103	4104	9999
4097	1	8	1	4104	4105	9999
4098	1	8	1	4105	4106	9999
4099	1	8	1	4106	4107	9999
4100	1	8	1	4107	4108	9999
4101	1	8	1	4108	4109	9999
4102	1	8	1	4109	4110	9999
4103	1	8	1	4110	4111	9999
4104	1	8	1	4111	4112	9999
4105	1	8	1	5101	5102	9999
4106	1	8	1	5102	5103	9999
4107	1	8	1	5103	5104	9999
4108	1	8	1	5104	5105	9999
4109	1	8	1	5105	5106	9999
4110	1	8	1	5106	5107	9999
4111	1	8	1	5107	5108	9999
4112	1	8	1	5108	5109	9999
4113	1	8	1	5109	5110	9999
4114	1	8	1	5110	5111	9999
4115	1	8	1	5111	5112	9999
4116	1	8	1	6101	6102	9999
4117	1	8	1	6102	6103	9999
4118	1	8	1	6103	6104	9999
4119	1	8	1	6104	6105	9999
4120	1	8	1	6105	6106	9999
4121	1	8	1	6106	6107	9999
4122	1	8	1	6107	6108	9999
4123	1	8	1	6108	6109	9999
4124	1	8	1	6109	6110	9999
4125	1	8	1	6110	6111	9999
4126	1	8	1	6111	6112	9999
4127	1	8	1	7101	7102	9999
4128	1	8	1	7102	7103	9999
4129	1	8	1	7103	7104	9999
4130	1	8	1	7104	7105	9999
4131	1	8	1	7105	7106	9999
4132	1	8	1	7106	7107	9999
4133	1	8	1	7107	7108	9999
4134	1	8	1	7108	7109	9999
4135	1	8	1	7109	7110	9999
4136	1	8	1	7110	7111	9999
4137	1	8	1	7111	7112	9999

%added mass on the main truss
2001	3	9	99	101	nan nan
2002	3	9	99	102	nan	nan
2003	3	9	99	103	nan	nan
2004	3	9	99	104	nan	nan
2005	3	9	99	105	nan	nan
2006	3	9	99	106	nan	nan
2007	3	9	99	107	nan	nan
2008	3	9	99	108	nan	nan
2009	3	9	99	109	nan	nan
2010	3	9	99	110	nan	nan
2011	3	9	99	111	nan	nan
2012	3	9	99	112	nan	nan
3001	3	9	99	201	nan	nan
3002	3	9	99	202	nan	nan
3003	3	9	99	203	nan	nan
3004	3	9	99	204	nan	nan
3005	3	9	99	205	nan	nan
3006	3	9	99	206	nan	nan
3007	3	9	99	207	nan	nan
3008	3	9	99	208	nan	nan
3009	3	9	99	209	nan	nan
3010	3	9	99	210	nan	nan
3011	3	9	99	211	nan	nan
3012	3	9	99	212	nan	nan

% added mass on the cross beam
5001  3   11   99  10301 nan nan
5002  3   11   99  10302 nan nan
5003  3   11   99  10303 nan nan
5004  3   11   99  10304 nan nan
5005  3   11   99  10305 nan nan
5006  3   11   99  10306 nan nan
5007  3   11   99  10307 nan nan
5008  3   11   99  10308 nan nan
5009  3   11   99  10309 nan nan
5010  3   11   99  10310 nan nan
5011  3   11   99  10311 nan nan
5012  3   11   99  10312 nan nan
5013  3   11   99  10313 nan nan
5014  3   11   99  10314 nan nan
5015  3   11   99  10315 nan nan
5016  3   11   99  10316 nan nan
5017  3   11   99  10317 nan nan
5018  3   11   99  10318 nan nan
5019  3   11   99  10319 nan nan
5020  3   11   99  10320 nan nan
5021  3   11   99  10321 nan nan
5022  3   11   99  10322 nan nan
5023  3   11   99  10323 nan nan

5101  3   11   99  10501 nan nan
5102  3   11   99  10502 nan nan
5103  3   11   99  10503 nan nan
5104  3   11   99  10504 nan nan
5105  3   11   99  10505 nan nan
5106  3   11   99  10506 nan nan
5107  3   11   99  10507 nan nan
5108  3   11   99  10508 nan nan
5109  3   11   99  10509 nan nan
5110  3   11   99  10510 nan nan
5111  3   11   99  10511 nan nan
5112  3   11   99  10512 nan nan
5113  3   11   99  10513 nan nan
5114  3   11   99  10514 nan nan
5115  3   11   99  10515 nan nan
5116  3   11   99  10516 nan nan
5117  3   11   99  10517 nan nan
5118  3   11   99  10518 nan nan
5119  3   11   99  10519 nan nan
5120  3   11   99  10520 nan nan
5121  3   11   99  10521 nan nan
5122  3   11   99  10522 nan nan
5123  3   11   99  10523 nan nan

5201  3   11   99  10701 nan nan
5202  3   11   99  10702 nan nan
5203  3   11   99  10703 nan nan
5204  3   11   99  10704 nan nan
5205  3   11   99  10705 nan nan
5206  3   11   99  10706 nan nan
5207  3   11   99  10707 nan nan
5208  3   11   99  10708 nan nan
5209  3   11   99  10709 nan nan
5210  3   11   99  10710 nan nan
5211  3   11   99  10711 nan nan
5212  3   11   99  10712 nan nan
5213  3   11   99  10713 nan nan
5214  3   11   99  10714 nan nan
5215  3   11   99  10715 nan nan
5216  3   11   99  10716 nan nan
5217  3   11   99  10717 nan nan
5218  3   11   99  10718 nan nan
5219  3   11   99  10719 nan nan
5220  3   11   99  10720 nan nan
5221  3   11   99  10721 nan nan
5222  3   11   99  10722 nan nan
5223  3   11   99  10723 nan nan

5301  3   11   99  10601 nan nan
5302  3   11   99  10602 nan nan
5303  3   11   99  10603 nan nan
5304  3   11   99  10604 nan nan
5305  3   11   99  10605 nan nan
5306  3   11   99  10606 nan nan
5307  3   11   99  10607 nan nan
5308  3   11   99  10608 nan nan
5309  3   11   99  10609 nan nan
5310  3   11   99  10610 nan nan
5311  3   11   99  10611 nan nan
5312  3   11   99  10612 nan nan
5313  3   11   99  10613 nan nan
5314  3   11   99  10614 nan nan
5315  3   11   99  10615 nan nan
5316  3   11   99  10616 nan nan
5317  3   11   99  10617 nan nan
5318  3   11   99  10618 nan nan
5319  3   11   99  10619 nan nan
5320  3   11   99  10620 nan nan
5321  3   11   99  10621 nan nan
5322  3   11   99  10622 nan nan
5323  3   11   99  10623 nan nan

5401  3   11   99  10401 nan nan
5402  3   11   99  10402 nan nan
5403  3   11   99  10403 nan nan
5404  3   11   99  10404 nan nan
5405  3   11   99  10405 nan nan
5406  3   11   99  10406 nan nan
5407  3   11   99  10407 nan nan
5408  3   11   99  10408 nan nan
5409  3   11   99  10409 nan nan
5410  3   11   99  10410 nan nan
5411  3   11   99  10411 nan nan
5412  3   11   99  10412 nan nan
5413  3   11   99  10413 nan nan
5414  3   11   99  10414 nan nan
5415  3   11   99  10415 nan nan
5416  3   11   99  10416 nan nan
5417  3   11   99  10417 nan nan
5418  3   11   99  10418 nan nan
5419  3   11   99  10419 nan nan
5420  3   11   99  10420 nan nan
5421  3   11   99  10421 nan nan
5422  3   11   99  10422 nan nan
5423  3   11   99  10423 nan nan
];

% % Check the node coordinates as follows:
figure; plotnodes(Nodes,'Numbering','off'); hold('on') % Check node and
% element definitions as follows: 
hold('on');
plotelem(Nodes,Elements,Types,'numbering','on','LineWidth',1);
% title('Nodes and elements');
% 
% Plot elements in different colors in order to check the section definitions
leng_section = length(Sections);
colors = jet(leng_section);
figure
for i = 1 : leng_section
    plotelem(Nodes,Elements(Elements(:,3)==Sections(i,1),:),Types,'Color',colors(i,:),'Numbering','off','LineWidth',2);
    hold('on');
end
title('Chuong Duong bridge - Sections')

% Degrees of freedom
% Assemble a column matrix containing all DOFs at which stiffness is
% present in the model:
DOF=getdof(Elements,Types);
%DOF=dof_truss(NodeNum);
% Remove all DOFs equal to zero from the vector:
% - 3D analysis: 
seldof=[0.06
        [101;201]+0.01;
        [101;201]+0.02;
        [101;201]+0.03;
        [112;212]+0.02;
        [112;212]+0.03;
        10001+0.00;
            10002+0.00;
            20001+0.00;
            20002+0.00;
            10012+0.00;
            20012+0.00;];
DOF=removedof(DOF,seldof);

% Assembly of stiffness matrix K
[K,M]=asmkm(Nodes,Elements,Types,Sections,Materials,DOF);
seldof_mass=[(101:112)'+0.03 ; (201:212)'+0.03];
P_concrete = (185.6/89.28)*8.64; %kn/m3
P_deck = (178/89.28)*8.64; %kn/m3
P_crossbeam = 27; %kn/m3

F_crossbeam = 27*0.3473; %kn/m3
F_concrete = P_concrete*74.267; %kn/m3
F_deck = P_deck*178.78; %kn/m3
F = F_crossbeam+F_concrete+F_deck;



% bvib manual
nMode=20;
[phi,omega]=eigfem(K,M,nMode);
% Display eigenfrequenties
disp('Lowest eigenfrequencies [Hz]');
f0=omega/2/pi;
idx=[ 1 2 4 5 6 7 ];
% fre_FEM = f0(idx);
% exp = [1.76
%     3.566
%     4.42
%     4.49 
%     4.95];
% ratio = ((fre_FEM-exp)/fre_FEM);
% R=ratio.';
for i = 1:2
figure(i);
plotdisp(Nodes,Elements,Types,DOF,phi(:,i),'DispMax','on')
end
figure;
plotdisp(Nodes,Elements,Types,DOF,phi(:,1),'DispMax','on')
figure;
plotdisp(Nodes,Elements,Types,DOF,phi(:,3),'DispMax','on')
figure;
plotdisp(Nodes,Elements,Types,DOF,phi(:,4),'DispMax','on')

figure;
subplot(2,2,1),plotdisp(Nodes,Elements,Types,DOF,phi(:,1),'DispMax','on');
subplot(2,2,2),plotdisp(Nodes,Elements,Types,DOF,phi(:,2),'DispMax','on');
subplot(2,2,3),plotdisp(Nodes,Elements,Types,DOF,phi(:,3),'DispMax','on');
subplot(2,2,4),plotdisp(Nodes,Elements,Types,DOF,phi(:,4),'DispMax','on');


% Animate eigenmodes

% for i = 1 : 7
%     figure(i);
%     animdisp(Nodes,Elements,Types,DOF,phi(:,i),'CreateMovie','off');
%     title(['Eigenmode ' num2str(i) ' with f(Hz)' num2str(a(i))])
% end
% 
% figure;
% plotdisp(Nodes,Elements,Types,DOF,phi(:,1))
% title('Eigenmode 11')
% figure;
% plotdisp(Nodes,Elements,Types,DOF,phi(:,2))
% title('Eigenmode 1')
% figure;
% plotdisp(Nodes,Elements,Types,DOF,phi(:,3))
% title('Eigenmode 2')
% figure;
% plotdisp(Nodes,Elements,Types,DOF,phi(:,4))
% title('Eigenmode 3')
% figure;
% plotdisp(Nodes,Elements,Types,DOF,phi(:,5))
% title('Eigenmode 4')
% figure;
% plotdisp(Nodes,Elements,Types,DOF,phi(:,6))
% title('Eigenmode 5')
% figure;
% plotdisp(Nodes,Elements,Types,DOF,phi(:,7))
% title('Eigenmode 6')

% Display eigenfrequenties
% disp('Lowest eigenfrequencies [Hz]');
% fre_FEM = a(idx)
% fre_MEA = [1.79;2.25;3.57;4.30;4.60;5.03;8.09];
% leng_fre_MEA = length(fre_MEA);
% Ratio = a(1:leng_fre_MEA)./fre_MEA

